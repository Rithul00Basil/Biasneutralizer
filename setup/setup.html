<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BiasNeutralizer Setup</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../sidepanel/sidepanel.css" />
  <link rel="stylesheet" href="setup.css" />
</head>
<body>
  <div class="panel-container setup-container">
    <!-- Header -->
    <div class="panel-header">
      <div class="header-content">
        <h1 class="product-name">
          <span class="bias">Bias</span><span class="neutralizer">Neutralizer</span>
        </h1>
        <p class="subtitle">Welcome! Let's Get You Set Up</p>
      </div>
      <div class="header-icon">
        <img src="../assets/logo.svg" alt="BiasNeutralizer Logo" />
      </div>
    </div>

    <!-- Setup Introduction -->
    <div class="setup-intro">
      <p class="intro-text">
        BiasNeutralizer can run AI analysis locally on your device for privacy and speed, 
        or use cloud models for more powerful analysis.
      </p>
    </div>

    <!-- Flags Instruction Step -->
    <div class="setup-card flags-step" id="flags-step">
      <div class="card-background"></div>
      <div class="card-content setup-card-content">
        <div class="setup-option-header">
          <div class="option-icon">‚öôÔ∏è</div>
          <h2 class="option-title">Enable Required Features</h2>
        </div>
        <p class="flags-description">
          For the best performance and privacy with on-device AI, go to <button type="button" class="flags-link" id="copy-flags-url">chrome://flags</button> and enable the following features:
        </p>
        <ul class="flags-list">
          <li><button type="button" class="flag-copy-btn" data-flag-name="Prompt API for Gemini Nano">Prompt API for Gemini Nano</button></li>
          <li><button type="button" class="flag-copy-btn" data-flag-name="Prompt API for Gemini Nano Multimodal">Prompt API for Gemini Nano Multimodal</button></li>
          <li><button type="button" class="flag-copy-btn" data-flag-name="Enables optimization guide on device">Enables optimization guide on device</button></li>
          <li><button type="button" class="flag-copy-btn" data-flag-name="Summarization API for Gemini Nano">Summarization API for Gemini Nano</button></li>
          <li><button type="button" class="flag-copy-btn" data-flag-name="Writer API for Gemini Nano">Writer API for Gemini Nano</button></li>
          <li><button type="button" class="flag-copy-btn" data-flag-name="Rewriter API for Gemini Nano">Rewriter API for Gemini Nano</button></li>
        </ul>
        <p class="flags-restart-note"><strong>Important:</strong> After enabling these flags you must restart Chrome.</p>
        <div class="flags-actions">
          <button id="flags-enabled-button" class="primary-button setup-button">I've Enabled Flags &amp; Restarted - Check Now</button>
        </div>
        <div class="flags-complete" id="flags-complete" style="display: none;">
          <p class="flags-complete-message">On-device model already detected on this device.</p>
          <button id="flags-continue-button" class="primary-button setup-button">Continue</button>
        </div>
        <div class="flags-status-message" id="flags-status-message" aria-live="polite"></div>
      </div>
    </div>

    <!-- On-Device Option Card -->
    <div class="setup-card step-hidden" id="on-device-card">
      <div class="card-background"></div>
      <div class="card-content setup-card-content">
        <div class="setup-option-header">
          <div class="option-icon">üîí</div>
          <h2 class="option-title">Download On-Device AI Model</h2>
          <span class="recommended-badge">Recommended</span>
        </div>
        
        <p class="option-description">
          Private, fast, works offline. Requires ~22GB disk space.
        </p>

        <div class="device-requirements" id="device-requirements">
          <p class="requirements-title">Requirements:</p>
          <ul class="requirements-list">
            <li>22GB free disk space</li>
            <li>4GB+ GPU or 16GB+ RAM</li>
            <li>Chrome 127+ (Built-in AI support)</li>
          </ul>
        </div>

        <div class="setup-status" id="setup-status" style="display: none;">
          <div class="status-message" id="status-message">Checking device compatibility...</div>
          <div class="progress-container" id="progress-container" style="display: none;">
            <div class="progress-bar">
              <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="progress-text" id="progress-text">0%</div>
          </div>
        </div>

        <button class="primary-button setup-button" id="download-model-button">
          <span id="download-button-text">Download Model</span>
        </button>
        
        <button class="secondary-button setup-button" id="cancel-download-button" style="display: none;">
          Cancel & Use Cloud
        </button>
      </div>
    </div>

    <!-- Cloud Option Card -->
    <div class="setup-card step-hidden" id="cloud-card">
      <div class="card-background"></div>
      <div class="card-content setup-card-content">
        <div class="setup-option-header">
          <div class="option-icon">‚òÅÔ∏è</div>
          <h2 class="option-title">Use Cloud Models</h2>
        </div>
        
        <p class="option-description">
          More powerful analysis, requires API key and internet connection.
        </p>

        <ul class="cloud-features">
          <li>‚úì Access to latest models</li>
          <li>‚úì More detailed analysis</li>
          <li>‚úì No disk space required</li>
          <li>‚ö† Requires Gemini API key</li>
        </ul>

        <button class="secondary-button setup-button" id="skip-cloud-button">
          Skip & Use Cloud
        </button>
      </div>
    </div>

    <!-- Support Message -->
    <div class="setup-footer">
      <p class="footer-note">
        You can change your AI preference later in Settings
      </p>
    </div>

    <!-- Notification Toast -->
    <div id="notification-toast">
      <span></span>
    </div>
  </div>

  <script src="setup.js" type="module"></script>
</body>
</html>
